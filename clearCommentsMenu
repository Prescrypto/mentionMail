function onOpen() {
  var ui = SpreadsheetApp.getUi();
  // Or DocumentApp or FormApp.
  ui.createMenu('Pr7o-Extras')
      .addItem('Delete all comments', 'menuItem1')
      .addItem('Change color to ‚ò¢Ô∏è‚ò¢Ô∏è‚ò¢Ô∏è and send email warning', 'menuItem2')
      .addItem('Change color to üî¥üî¥üî¥ and send email warning', 'menuItem3')
      .addSeparator()
      .addToUi();
}

function menuItem1() {
  SpreadsheetApp.getActiveSheet().clear({commentsOnly: true});
}

function menuItem2() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetURL = ss.getUrl();
  // Change the background color of selected range to YELLOW
  var color = SpreadsheetApp.getActiveRange().setBackground("yellow");
  // Get actual background color of selected cells
  var color = SpreadsheetApp.getActiveRange().getBackgroundColor();
  // Get a list of values of selected cells
  var mentions = SpreadsheetApp.getActiveRange().getValues();
  Logger.log(mentions);
  // Get values from the first sheet in the document
  var sheet = SpreadsheetApp.openById("spreadsheetID"); // replace you spread sheet ID for "spreadsheetID"
  var data = sheet.getDataRange().getValues();
  // Sets a value for the email subject
  var subject = "üëª  Mando de Control WARNING ‚ö†Ô∏è: Objective color change to ‚ò¢Ô∏è ‚ò¢Ô∏è ‚ò¢Ô∏è YELLOW";
  var content = "One of your objectives has changed color to ‚ò¢Ô∏è‚ò¢Ô∏è‚ò¢Ô∏è Go find out at:";

  // Iterates over @Mentions found and sets them in a temporal variable in lowerCase and removes extra characters
  for (var i = 0; i < mentions[0].length; i++) {
    var correctMention = mentions[0][i].toLowerCase().replace(/[^\w\s]/gi, '');
    Logger.log("Correct mention: " + correctMention);
    // Iterates over list of mails and sets them in a temporal variable in lowerCase and removes extra characters
    for (var j = 0; j < data.length; j++) {
      var correctName = data[j][0].toLowerCase().replace(/[^\w\s]/gi, '');
      Logger.log(correctName);
      if (correctMention == correctName) {
        MailApp.sendEmail(data[j][1], subject, content + "\n" + sheetURL);
      }
    }
  }
}

function menuItem3() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetURL = ss.getUrl();
  // Change the background color of selected range to YELLOW
  var color = SpreadsheetApp.getActiveRange().setBackground("red");
  // Get actual background color of selected cells
  var color = SpreadsheetApp.getActiveRange().getBackgroundColor();
  // Get a list of values of selected cells
  var mentions = SpreadsheetApp.getActiveRange().getValues();
  Logger.log(mentions);
  // Get values from the first sheet in the document
  var sheet = SpreadsheetApp.openById("spreadsheetID"); // replace you spread sheet ID for "spreadsheetID"
  var data = sheet.getDataRange().getValues();
  // Sets a value for the email subject
  var subject = "üëª Mando de Control WARNING üõë: Objective color change to üî¥ üî¥ üî¥ RED";
  var content = "One of your objectives has changed color to üî¥üî¥üî¥ Go find out at:";

  // Iterates over @Mentions found and sets them in a temporal variable in lowerCase and removes extra characters
  for (var i = 0; i < mentions[0].length; i++) {
    var correctMention = mentions[0][i].toLowerCase().replace(/[^\w\s]/gi, '');
    Logger.log("Correct mention: " + correctMention);
    // Iterates over list of mails and sets them in a temporal variable in lowerCase and removes extra characters
    for (var j = 0; j < data.length; j++) {
      var correctName = data[j][0].toLowerCase().replace(/[^\w\s]/gi, '');
      Logger.log(correctName);
      if (correctMention == correctName) {
        MailApp.sendEmail(data[j][1], subject, content + "\n" + sheetURL);
      }
    }
  }
}
